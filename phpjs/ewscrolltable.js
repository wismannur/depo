/**
 * Scrolling Table for PHPMaker 2018
 * @license (C) 2018 e.World Technology Ltd.
 */
if(!window.ew_ScrollableTable){function ew_ScrollableTable(elContainer,width,height){var j=jQuery,$container=$("#"+elContainer),tbd=$container.find("table.ewTable")[0],ua=EW_MOBILE_DETECT;if(!EW_IS_MOBILE&&ua.version("MSIE")<8||EW_IS_MOBILE&&ua.mobileGrade()!="A"||!width&&!height||!tbd||!tbd.rows||!$container[0]||!$container.is("div.ewGridMiddlePanel"))return;var isMobile=function(){return EW_IS_MOBILE||!EW_IS_SCREEN_SM_MIN};var getWidth=function(){return isMobile()?"100%":width};var timer,$subContainers=$(),$tbd=$(tbd),$window=$(window),$grid=$container.addClass("ewScrollableTable").closest(".ewGrid").css({display:"block","min-width":0}),$panels=$grid.find(".ewGridLowerPanel, .ewGridUpperPanel"),$form=$grid.closest(".ewForm:not(.ewListForm)"),isDetail=!!$form[0],$detailPages=$grid.closest(".ewDetailPages").css("display","block"),$tabPane=$grid.closest(".tab-pane"),$tab=$detailPages.find("a[data-toggle=tab][href='#"+$tabPane.attr("id")+"']"),$panelCollapse=$grid.closest(".panel-collapse"),$collapse=$detailPages.find("a[data-toggle=collapse][href='#"+$panelCollapse.attr("id")+"']");var _setWidths=function(){var t=getWidth();$grid.width(isDetail?"100%":t);$panels.innerWidth("100%");$subContainers.width("100%");$container.removeClass("invisible")};var setWidths=function(){if(isDetail){if($tab.parent().hasClass("active")||$panelCollapse.hasClass("in")){_setWidths()}else{$tab.on("shown.bs.tab",_setWidths);$panelCollapse.on("shown.bs.collapse",_setWidths)}}else{_setWidths()}};var init=function(){if($container.data("ScrollableTable"))return;var yscroll=height,elContainer=$container[0],width=getWidth();if(isDetail&&width)$form.width(width);$(tbd.rows).each(function(){$(this.cells).each(function(){$(this).wrapInner("<div></div>")})});var rowcnt=tbd.tHead.rows.length;var awidth=$(tbd.tHead.rows[rowcnt-1].cells).map(function(){return this.firstChild.offsetWidth}).get();var colcnt=awidth.length;$grid.width(isDetail?"100%":width);$container.width(width?"100%":"").height(height?"100%":"").css("overflowX",width?"auto":"hidden").css("overflowY",height?"auto":"hidden");var xscrolling=width&&elContainer.scrollWidth>elContainer.clientWidth;var yscrolling=height&&elContainer.scrollHeight>elContainer.clientHeight;$container.addClass("invisible").width("").height("").css("overflowX","hidden").css("overflowY","hidden");var tr,thd,$thd;if(yscroll){var $hdContainer=$("<div></div>").width(width||"").addClass("ewScrollableTableHeader").appendTo($container);var $pthd=$("<table></table>").attr({border:0,cellSpacing:0,cellPadding:0,width:"100%"});tr=$pthd[0].insertRow(-1);$(tr).addClass("ewTableHeader");$thd=$("<table></table>").attr({border:0,cellSpacing:0,cellPadding:0}).addClass("ewTable ewTableSeparate").appendTo($(tr.insertCell(-1)).css({padding:"0px",border:"0px"}));thd=$thd[0];$hdContainer.append($pthd);$subContainers=$subContainers.add($hdContainer)}var $bdContainer=$("<div></div>").width(width||"").height(height||"").css("overflowX",width?"auto":"hidden").css("overflowY",height?"auto":"hidden").addClass("ewScrollableTableBody").scroll(function(t){if($hdContainer)$hdContainer.scrollLeft(this.scrollLeft)});$container.append($bdContainer);$subContainers=$subContainers.add($bdContainer);$bdContainer.append(tbd);if(yscroll){$(tbd.tHead).clone().appendTo(thd);$(tbd.tHead).hide()}if(awidth&&tbd.rows&&tbd.rows[0]&&tbd.rows[0].cells){var stmt="";for(var i=0;i<colcnt;i++){if(thd&&thd.tHead&&thd.tHead.rows&&thd.tHead.rows[rowcnt-1]&&thd.tHead.rows[rowcnt-1].cells.length==colcnt)stmt+="thd.tHead.rows["+(rowcnt-1)+"].cells["+i+"].firstChild.style.width='"+awidth[i]+"px';";for(var j=0,rcnt=tbd.rows.length;j<rcnt;j++){if(tbd.rows[j].cells.length==colcnt)stmt+="tbd.rows["+j+"].cells["+i+"].firstChild.style.width='"+awidth[i]+"px';"}}if(stmt!="")eval(stmt)}var bdContainer=$bdContainer[0];yscrolling=bdContainer.scrollHeight>bdContainer.clientHeight;xscrolling=bdContainer.scrollWidth>bdContainer.clientWidth;if(yscroll&&yscrolling&&tr){var ohw=bdContainer.offsetWidth-bdContainer.clientWidth;$(tr.insertCell(-1)).addClass("ewScrollableTableOverhang").html($("<div></div>").width(ohw)).width(ohw)}ew_SetupTable(-1,tbd);if(yscroll&&tbd.rows&&bdContainer.clientHeight>tbd.offsetHeight){var $rows=$(tbd.rows).filter(":not(."+EW_ITEM_TEMPLATE_CLASSNAME+")");var n=$rows.filter("[data-rowindex=1]").length||$rows.filter("[data-rowindex=0]").length||1;$rows.filter(":gt("+(-1*n-1)+")").find("td."+EW_TABLE_LAST_ROW_CLASSNAME).removeClass(EW_TABLE_LAST_ROW_CLASSNAME).addClass(EW_TABLE_BORDER_BOTTOM_CLASSNAME)}$window.resize(function(){clearTimeout(timer);timer=setTimeout(setWidths,250)});setWidths();$container.data("ScrollableTable",true)};if(isDetail){if($tab.parent().hasClass("active")||$panelCollapse.hasClass("in")){init()}else{$tab.on("shown.bs.tab",init);$panelCollapse.on("shown.bs.collapse",init)}}else{init()}}}